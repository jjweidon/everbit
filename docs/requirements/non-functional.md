# 비기능 요구사항 (NFR)

## 3.1 보안

* 시크릿은 Git 커밋 금지(.gitignore), AI 인덱싱 금지(.cursorignore)
* 업비트 키 저장 시 **AES-GCM 등 인증 암호로 암호화 + 키는 운영 환경변수에서 주입**
* JWT:

  * Access 짧게(예: 15m), Refresh 길게(예: 14d)
  * 탈취 대비: Refresh 로테이션(권장)
* 레이트리밋 준수:

  * Upbit는 그룹별 초당 제한 + 429/418 정책 존재 → 공통 Throttling/백오프 모듈화 ([업비트 개발자 센터](https://docs.upbit.com/kr/reference/rate-limits))

## 3.2 신뢰성/장애 대응

* 재시작 시 중복 주문 방지: `identifier` 기반 멱등(필수)
* 외부 API 장애 시:

  * 주문 API 실패는 재시도하되, 재시도는 멱등키로만 수행
  * 일정 횟수 실패 시 해당 마켓만 비활성화(전략 전체 중단은 Kill Switch로 수동)

## 3.3 성능

* **백테스트**:

  * 멀티 마켓/멀티 타임프레임 병렬 처리(단, 레이트리밋/IO 고려)
  * "1년치 * N마켓"을 현실적으로 처리 가능한 파이프라인(배치/캐시/DB 인덱스 필수)
* **실거래**:

  * 시장 데이터 수집은 WebSocket 우선(가능하면), REST는 보조(레이트리밋 보호)

## 3.4 관측 가능성(Observability)

* Prometheus 메트릭: 주문 성공/실패, API 429 카운트, 전략별 PnL, 지연 시간
* Grafana 대시보드: 최소 1개(트레이딩 상태/에러/레이트리밋)
